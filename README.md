# A system supporting code comprehension based on large language models and a semantic code graph

Created system is a tool that can be used by professional programmers to better understand large and developing
projects, or starting programmers to easier learn coding based on given project.
To get wider context it uses SCG graph, and more specifically [scg-cli tool](https://github.com/VirtusLab/scg-cli) to
generate it.

System is an MCP Server that can be used with tool chosen by the user. It supports code written in Scala and Java

## Version of system

### Branch `main`

    For general use version listed on branch `main`. It logs errors and events to `server_debug.log` file.

### Branch `fast-api`

    For testing and further developing application use version listed on branch `fast-api`.
    To run it use: 'uvicorn src.app.main:app --reload'

## Methods of MCP Server

MCP Server has 4 main methods. Each of them can be called one of four paths to retrieve context of code entities.

1. ask_specific_nodes - used to retrieve context of specific node/nodes included in question
2. ask_top_nodes - used to retrieve context to question related to ranking nodes
3. ask_general_question - used to retrieve context to question without mentioned specific node/nodes
4. list_related_entities - used to get all related entities to entity specified in question

To better understand how these method works read file [AGENT.md](src/clients/AGENT.md)

## Basic flow of the system

<img src="basic-flow.png">

## How to run

1. Download https://github.com/jciura/scg-cli-modified/tree/main, and create environmental variable to \bin folder.
2. Generate .semanticgraph files, SCG graph file, file containing metrics of SCG and embeddings for project using
   `app\main_runner.py` with argument: `--project path_to_project` - It may take a while for big projects
   If project is written in Scala .semanticgraph files need to be generated by user. More on this
   in [here](https://github.com/VirtusLab/scg-cli?tab=readme-ov-file#generating-project-scg-metadata)
2. Connect MCP Server to Agent that is supposed to choose MCP function, it's parameters and formulate question.

   General form to add MCP Server is listed below:
    ```json
   {
   "mcpServers": {
    "scg-context": {
      "command": "python",
      "args": ["{PROJECT_PATH}/src/clients/mcpserver.py"],
    }
   }
   }
   ```
3. Create `.env` file in project root:
```bash
cp .env.example .env
```
4. Fill in your API keys in `.env`.

5. Start asking question related to project

